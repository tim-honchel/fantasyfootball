

using FantasyFootball.DataAccess.Implementations;
using Microsoft.Extensions.Configuration;
using NUnit.Framework;
using System.Buffers;

namespace FantasyFootball.Tests.DataAccess.Implementations
{
    [TestFixture]
    public class RulesRepositoryTests
    {
        public static readonly IConfiguration _configuration;
        public RulesRepository _repository = new RulesRepository(_configuration);

        [Test]
        public async Task RequestRules_Returns_Rules_Given_ValidLeagueIDAndCookie()
        {
            int leagueID = 1472201749;
            string cookie = "AMCVS_EE0201AC512D2BE80A490D4C%40AdobeOrg=1; _omnicwtest=works; s_ecid=MCMID%7C57846649342008950800150023386373424378; AMCV_EE0201AC512D2BE80A490D4C%40AdobeOrg=-330454231%7CMCIDTS%7C19562%7CMCMID%7C57846649342008950800150023386373424378%7CMCAAMLH-1690752007%7C7%7CMCAAMB-1690752007%7CRKhpRz8krg2tLO6pguXWp5olkAcUniQYPHaMWWgdJ3xzPWQmdj0y%7CMCOPTOUT-1690154407s%7CNONE%7CMCAID%7CNONE%7CvVersion%7C3.1.2; check=true; _cc_id=8d812b487892c6aee61cf42f14814dd0; panoramaId_expiry=1690752008333; panoramaId=ac98f3b55fe7ab02e8beeecaf52bbd9563ce30edf16ee417e023bd452fbaab17; panoramaIdType=panoIndiv; tveMVPDAuth=; tveAuth=; _gcl_au=1.1.1614743705.1690147210; block.check=false%7Cfalse; s_c24_s=First%20Visit; s_cc=true; _cb=5mjovDqmlt1gzSrv; IR_gbd=espn.com; tvid=28432ce60f7c4d2e983ece2e766b6d90; _fbp=fb.1.1690147211660.1720788088; ESPN-ONESITE.WEB-PROD.api=k8VI9oro4SpZb++vZ6wyf08vqz/o/Ut1kvD2aIIkXsAkpGizclxOlTl+NI+SbLwkDz1VR5NnoFydHwrvf1uPBe02OrEH; device_1f900fea=ab511c3f-83c4-40aa-a88f-2893e75b506d; SWID={5392B6D6-D775-475C-833C-5AEB107000B2}; ESPN-ONESITE.WEB-PROD.token=5=eyJhY2Nlc3NfdG9rZW4iOiI0MTJjYTI5NmIwY2Q0YWU0ODQ2YmUxZmViMGQwYzY1MiIsInJlZnJlc2hfdG9rZW4iOiI5ZGM0NTJkNjJhNWU0Y2I3YTRkNDJmZjI5Y2EzZDc4MiIsInN3aWQiOiJ7NTM5MkI2RDYtRDc3NS00NzVDLTgzM0MtNUFFQjEwNzAwMEIyfSIsInR0bCI6ODY0MDAsInJlZnJlc2hfdHRsIjoxNTU1MjAwMCwiaGlnaF90cnVzdF9leHBpcmVzX2luIjoxNzk5LCJpbml0aWFsX2dyYW50X2luX2NoYWluX3RpbWUiOjE2OTAxNDcyMzY2NDIsImlhdCI6MTY5MDE0NzIzNjAwMCwiZXhwIjoxNjkwMjMzNjM2MDAwLCJyZWZyZXNoX2V4cCI6MTcwNTY5OTIzNjAwMCwiaGlnaF90cnVzdF9leHAiOjE2OTAxNDkwMzUwMDAsInNzbyI6bnVsbCwiYXV0aGVudGljYXRvciI6ImRpc25leWlkIiwibG9naW5WYWx1ZSI6bnVsbCwiY2xpY2tiYWNrVHlwZSI6bnVsbCwic2Vzc2lvblRyYW5zZmVyS2V5IjoiRWlhOUxTMkRmQVpKNm41NDAzd3Z3OUR4eUI3MUhDZDVrcUxnQzR2QnhfR2U5N0dXOTU3d09rVF9tNnd0MEJiakRRQldXZjFfaHFrT1lkQjJHSDVQRzJRdVY5YlJYeGg3VTFJVkpyaXhZc0xkbWZlSkZMUSIsImNyZWF0ZWQiOiIyMDIzLTA3LTIzVDIxOjIwOjM2LjgwNloiLCJsYXN0Q2hlY2tlZCI6IjIwMjMtMDctMjNUMjE6MjA6MzYuODA2WiIsImV4cGlyZXMiOiIyMDIzLTA3LTI0VDIxOjIwOjM2LjAwMFoiLCJyZWZyZXNoX2V4cGlyZXMiOiIyMDI0LTAxLTE5VDIxOjIwOjM2LjAwMFoifQ==|eyJraWQiOiJxUEhmditOL0tONE1zYnVwSE1PWWxBc0pLcWVaS1U2Mi9DZjNpSm1uOEJ6dzlwSW5xbTVzUnc9PSIsImFsZyI6IlJTMjU2In0.eyJpc3MiOiJodHRwczovL2F1dGhvcml6YXRpb24uZ28uY29tIiwic3ViIjoiezUzOTJCNkQ2LUQ3NzUtNDc1Qy04MzNDLTVBRUIxMDcwMDBCMn0iLCJhdWQiOiJFU1BOLU9ORVNJVEUuV0VCLVBST0QiLCJleHAiOjE2OTAyMzM2MzYsImlhdCI6MTY5MDE0NzIzNiwianRpIjoiMzQ5XzVvSWtVZ2xwMGlrY0ZpbHlNUSIsIm5iZiI6MTY5MDE0NzE3NiwiYV90eXAiOiJPTkVJRF9UUlVTVEVEIiwiYV9jYXQiOiJHVUVTVCIsImF0ciI6ImRpc25leWlkIiwic2NvcGVzIjpbImR0c3MtZW50aXRsZW1lbnQtdXNlci1hZG1pbiIsIkFVVEhaX0dVRVNUX1NFQ1VSRURfU0VTU0lPTiJdLCJjX3RpZCI6IjEzMjQiLCJpZ2ljIjoxNjkwMTQ3MjM2NjQyLCJodGF2IjoyLCJodGQiOjE4MDAsInJ0dGwiOjE1NTUyMDAwLCJlbWFpbCI6InRpbS5ob25jaGVsQGdtYWlsLmNvbSJ9.LcAZIg27GOjunawo0ekjmiE8FixlBnoyPHvABKwj5wNQLxBEeGQ85aN5lojSeQ809f9v7El2YvR_AmvZ5w3gArEpd6zwb0xmDMY4N2oIksAPNId4zADufaiQ30rtJlWEqXP_ujTcRHH-kcTa-fExiX8XgmLnecse8gg0ZItwKHg-uxy_dQOSMA71X5vP01eozvB1_Rq8riOwWfxXxg_GNK4zyH-8-5VTYTT0s49SDxLMIxZCObdl0TREkLV65BS6qWwpkJ4kR-LNzWL4RAWdrS0gF1zMCSMUETOHLPgiVQEsnNeligOgaSK5sMEvqUJbll9P8SNVMOx7gN60E7cgPQ; ESPN-ONESITE.WEB-PROD-ac=XUS; espnAuth={\"swid\":\"{5392B6D6-D775-475C-833C-5AEB107000B2}\"}; userZip=45504; mbox=session#aba71903468541c6a70fff30f6306822#1690149098|PC#aba71903468541c6a70fff30f6306822.34_0#1753392008; _cb_svref=https%3A%2F%2Fwww.espn.com%2F; country=us; cto_bundle=s2-hLl9jVjZWNjlzbW5LVEdtdWx2QnUyU25mSlNmZUJPZ0hvTWhaTmYlMkZaaVJwYzVFMG44dVg2Rmt1R2dNcEpHMG5WblVSY3VHSUpodnpudk1kRmJ5ODB4YTk4d0k3cEolMkJ6MWIxNE55SVBnM1BUUlhEcmRoc0ZHTDdDeTlyUWMyJTJCUUtPeUNaNWJ0NHBhd0E5bHY4c2d2dEkxcEElM0QlM0Q; s_omni_lid=%5B%5BB%5D%5D; espn_s2=AEAWmky5Nuh0MwOGvJGRkxNE0bF91aYMG%2FgJB2ssS0xxGVdHfPk9xWqfmfSIF%2F%2BHzgopMMbmRLJLoCaL3hCh0%2BpblHtYrR5HdoRl2haYsKong%2FtBv9tUPdKKFM33d5fdocudM7xOy84XiIP1hO7DCI4G8gH48jTuU2MI37cG9%2F4ylyLg29j4nnkC57R7gClcSACgw7L9kGYxVJnoFgwmCrinamlJVlAlZKVLlszt4XW1lRt6yxTaSh%2B5aD2wRQZIvJUw%2Fmy2js9UaCyPzUxVuF5s; ESPN-ONESITE.WEB-PROD.idn=00b0361dc8; __gads=ID=7f7dab76a657aa2e:T=1690147208:RT=1690149839:S=ALNI_MahYH-ejwW9Zp9gGzjTEi7H6p1zsw; __gpi=UID=000009ab9eb7df18:T=1690147208:RT=1690149839:S=ALNI_Ma9_qUBmogfrVFrKlgdDV_oFT6gag; s_fid=005B97D36ED7602A-3EDF17C4E5D9E9F8; ctoLocalVisitor={%22localVisitorId%22:%221690149844261-3310325076726%22}; ctoLocalSession={%22localSessionId%22:%221690149844260-1479895043767%22%2C%22prevPageName%22:%22dgame:espn:homepage%20/%20category|Fantasy%20Football%20/%20section|welcome_to_fantasy_football:Article%20|%20legal_restrictions%22}; __zlcmid=1GzlzbQAmfIHjMg; ctoBrowserSession=1690149848348; ctoSession={%22arPageName%22:%22dgame:espn:homepage%20/%20category|Fantasy%20Football%20/%20section|welcome_to_fantasy_football:Article%20|%20legal_restrictions%22%2C%22firstSessionPageName%22:%22dgame:espn:homepage%20/%20category|Fantasy%20Football%20/%20section|welcome_to_fantasy_football:Article%20|%20legal_restrictions%22%2C%22sessionFirstRefUrl%22:%22https://fantasy.espn.com/%22%2C%22firstSessionUrl%22:%22https://support.espn.com/hc/en-us/articles/115003859212-Legal-Restrictions%22%2C%22hitCount%22:1%2C%22timestamp%22:1690149848350}; ctoVisitor={%22firstPageName%22:%22dgame:espn:homepage%20/%20category|Fantasy%20Football%20/%20section|welcome_to_fantasy_football:Article%20|%20legal_restrictions%22%2C%22firstRefUrl%22:%22https://fantasy.espn.com/%22%2C%22firstUrl%22:%22https://support.espn.com/hc/en-us/articles/115003859212-Legal-Restrictions%22%2C%22sessionCount%22:4}; s_ensNR=1690149854142-New; OptanonConsent=isGpcEnabled=0&datestamp=Sun+Jul+23+2023+18%3A04%3A14+GMT-0400+(Eastern+Daylight+Time)&version=202212.1.0&isIABGlobal=false&hosts=&consentId=af431c94-834d-493d-b281-60b738637f45&interactionCount=1&landingPath=NotLandingPage&groups=C0001%3A1%2CC0003%3A1%2CSSPD_BG%3A1%2CC0002%3A1%2CC0004%3A1%2CC0005%3A1&AwaitingReconsent=false; IR_9070=1690149854382%7C0%7C1690149854382%7C%7C; _chartbeat2=.1676652487573.1690149854393.0000000000000001.DEIRIlBgdhN3BVg2PiCRhPkGKOO6i.18; _chartbeat5=; s_c24=1690149854611; s_gpv_pn=fantasy%3Afootball%3Aleague%3Asettings%3Asummary; s_c6=1690149854613-New; s_sq=%5B%5BB%5D%5D; _chartbeat4=t=DW-GySC9tbrxC4R671rP5LKBjKzc8&E=16&x=0&c=0.31&y=5250&w=697";

            var response = _repository.RequestRules(leagueID, cookie);
        }
    }
}
